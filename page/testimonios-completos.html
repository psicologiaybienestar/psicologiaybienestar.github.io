<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todos los Testimonios - Psicología & Bienestar</title>
    <link rel="icon" type="image/png" href="/assets/logo-ico.png">

    <link rel="icon" href="/assets/logo.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Incluye aquí los estilos personalizados de tu index.html
           que no sean solo de Tailwind y que quieras mantener,
           como la fuente Sego Serif, scroll-behavior, etc.
           No necesitas los estilos de las tarjetas que ya te doy abajo
           ni los de las animaciones de volteo.
        */
        @font-face {
            font-family: "Sego Serif";
            src: url("fonts/sego-serif.ttf") format("truetype");
            font-weight: normal;
            font-style: normal;
        }

        .font-sego {
            font-family: "Sego Serif", serif;
        }

        html {
            scroll-behavior: smooth;
        }


        /* --- Estilos de las tarjetas de testimonios (copiados de index) --- */
        .comentario-tarjeta {
            background-color: #fff;
            /* Fondo blanco para las tarjetas */
            color: #333;
            /* Color base oscuro para el texto general */
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            /* En esta página no necesitan min-height ni overflow-y,
               ya que queremos mostrar el texto completo */
            /* height: auto; */
            /* min-height: auto; */
            /* overflow-y: visible; */
            box-sizing: border-box;
            border: 1px solid #ddd;
            height: 100%;
            /* Ayuda en el grid para que las tarjetas de la misma fila tengan la misma altura */
        }

        .comentario-tarjeta .testimonio {
            color: #333;
            font-style: italic;
            margin-bottom: 15px;
            flex-grow: 1;
            /* Permite que el testimonio ocupe el espacio restante */
            /* Quitar estilos de scroll si estaban */
            overflow-y: visible;
            padding-right: 0;
        }

        /* Asegurarse de que no tengan scrollbars ocultas */
        .comentario-tarjeta .testimonio::-webkit-scrollbar {
            display: auto;
        }

        .comentario-tarjeta .testimonio {
            -ms-overflow-style: auto;
            scrollbar-width: auto;
        }


        .comentario-tarjeta .nombre {
            color: #627eff;
            font-weight: bold;
            margin-top: 10px;
            margin-bottom: 5px;
            text-align: right;
        }

        .comentario-tarjeta .calificacion-fecha {
            color: #627eff;
            font-size: 0.9em;
            text-align: right;
        }

        .comentario-tarjeta .calificacion-fecha span {
            margin-left: 15px;
        }

        /* --- Fin Estilos de las tarjetas de testimonios --- */


        /* --- Estilos para el Grid de Testimonios --- */
        #grid-testimonios {
            display: grid;
            gap: 25px;
            /* Espacio entre las tarjetas en el grid */
            padding: 0 20px;
            /* Padding lateral dentro del contenedor */
            max-width: 1200px;
            /* Ancho máximo del grid (ajusta si es necesario) */
            margin: 0 auto;
            /* Centra el grid */
        }

        /* Grid responsive: 1 columna en móvil, 2 en tablet, 3 en desktop */
        @media (min-width: 640px) {

            /* sm breakpoint en Tailwind */
            #grid-testimonios {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                /* 2 columnas flexibles en pantallas pequeñas */
                gap: 20px;
            }
        }

        @media (min-width: 1024px) {

            /* lg breakpoint en Tailwind */
            #grid-testimonios {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
                /* 3 columnas flexibles en desktop */
                gap: 25px;
            }
        }

        /* --- Fin Estilos para el Grid de Testimonios --- */
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5397310873335886"
        crossorigin="anonymous"></script>
</head>

<body class="bg-white text-gray-800">

    <header class="bg-[#66a6da] text-white shadow-md fixed w-full top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto flex justify-between items-center p-4">
            <div class="flex items-center">
                <img src="/assets/logo.png" alt="Logo Psicología y Bienestar" class="h-10 w-10 mr-2">
                <h1 class="text-xl font-bold font-sego lg:text-2xl">Psicología & Bienestar</h1>
            </div>
            <nav id="menu" class="hidden md:flex space-x-4 text-sm font-semibold">
                <a href="/index.html#inicio"
                    class="hover:bg-white/10 hover:rounded py-2 px-3 transition duration-300">Inicio</a>
                <a href="/index.html#nosotros"
                    class="hover:bg-white/10 hover:rounded py-2 px-3 transition duration-300">Sobre
                    Nosotros</a>
                <a href="/index.html#servicios"
                    class="hover:bg-white/10 hover:rounded py-2 px-3 transition duration-300">Servicios</a>
                <a href="/index.html#equipo"
                    class="hover:bg-white/10 hover:rounded py-2 px-3 transition duration-300">Equipo</a>
                <a href="/index.html#contacto"
                    class="hover:bg-white/10 hover:rounded py-2 px-3 transition duration-300">Contacto</a>
            </nav>
            <button id="menu-toggle" class="md:hidden focus:outline-none">
                <svg class="w-6 h-6 fill-current text-white" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M4 6H20V8H4V6ZM4 11H20V13H4V11ZM4 16H20V18H4V16Z" />
                </svg>
            </button>
        </div>
        <div id="mobile-menu" class="md:hidden hidden bg-[#66a6da] px-4 pb-4">
            <a href="/index.html#inicio" class="block py-2 hover:text-gray-200">Inicio</a>
            <a href="/index.html#nosotros" class="block py-2 hover:text-gray-200">Sobre Nosotros</a>
            <a href="/index.html#servicios" class="block py-2 hover:text-gray-200">Servicios</a>
            <a href="/index.html#equipo" class="block py-2 hover:text-gray-200">Equipo</a>
            <a href="/index.html#contacto" class="block py-2 hover:text-gray-200">Contacto</a>
        </div>
    </header>
    <main class="pt-20 py-12">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-[#627eff] text-center mb-10">Todos los Testimonios</h2>

            <div id="grid-testimonios">
            </div>
        </div>
    </main>


    <footer class="bg-[#66a6da] text-white text-center py-8 mt-12">
        <div class="container mx-auto">
            <p class="font-sego text-sm mb-2">Psicología & Bienestar © 2025. Todos los derechos reservados.</p>
        </div>
    </footer>
    <div class="fixed top-1/3 left-0 z-40 flex flex-col space-y-3 px-2">
        <a href="https://www.instagram.com/serviciospsicobienestar?utm_source=qr&igsh=NmtoOWFqMnZwMHY1" target="_blank"
            class="group relative flex items-center">
            <div class="bg-pink-500 hover:bg-pink-600 p-3 rounded-r-full shadow-lg transition duration-300">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v10/icons/instagram.svg" alt="Instagram"
                    class="w-5 h-5" />
            </div>
            <span
                class="absolute left-12 bg-pink-500 text-white text-xs px-3 py-1 rounded shadow-lg opacity-0 scale-0 group-hover:opacity-100 group-hover:scale-100 transform transition-all duration-300 origin-left whitespace-nowrap">
                Visita nuestro Instagram
            </span>
        </a>

        <a href="https://www.facebook.com/share/1A9WZs7XCb/" target="_blank" class="group relative flex items-center">
            <div class="bg-blue-600 hover:bg-blue-700 p-3 rounded-r-full shadow-lg transition duration-300">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v10/icons/facebook.svg" alt="Facebook"
                    class="w-5 h-5" />
            </div>
            <span
                class="absolute left-12 bg-blue-600 text-white text-xs px-3 py-1 rounded shadow-lg opacity-0 scale-0 group-hover:opacity-100 group-hover:scale-100 transform transition-all duration-300 origin-left whitespace-nowrap">
                Visita nuestro Facebook
            </span>
        </a>
    </div>

    <a href="https://wa.me/573164603881" target="_blank" class="fixed bottom-6 right-6 z-50 group">
        <div
            class="relative flex items-center justify-center bg-[#25D366] hover:bg-green-600 w-14 h-14 rounded-full shadow-lg transition-colors duration-300">
            <img src="https://cdn.jsdelivr.net/npm/simple-icons@v10/icons/whatsapp.svg" alt="WhatsApp"
                class="w-7 h-7 text-white" />
            <span
                class="absolute right-16 bg-[#25D366] text-white text-sm px-3 py-1 rounded-lg shadow-lg opacity-0 scale-0 group-hover:opacity-100 group-hover:scale-100 transform transition-all duration-300 origin-right whitespace-nowrap">
                Escríbenos por WhatsApp
            </span>
        </div>
    </a>
    <script>
        // === JavaScript para mobile menu toggle (Copiado de index.html) ===
        const menuToggle = document.getElementById("menu-toggle");
        const mobileMenu = document.getElementById("mobile-menu");
        const mobileMenuItems = document.querySelectorAll("#mobile-menu a");

        if (menuToggle) { // Check if menuToggle exists
            menuToggle.addEventListener("click", () => {
                mobileMenu.classList.toggle("hidden");
            });
        }


        mobileMenuItems.forEach(item => {
            item.addEventListener("click", () => {
                if (window.innerWidth < 768) {
                    mobileMenu.classList.add("hidden");
                }
            });
        });
        // === Fin mobile menu toggle ===


        // === JavaScript para cargar y mostrar TODOS los testimonios ===
        document.addEventListener('DOMContentLoaded', () => {

            const gridTestimoniosContenedor = document.getElementById('grid-testimonios');
            const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ9gc0iLBVHnuWopuxijsTupBn_tvZ-B7D3b4WBVZ-meyKF61a8o24Qy1FQ5fxUYL7DaabkkAgILjac/pub?gid=421205038&single=true&output=csv';

            // --- FUNCIÓN PARA PARSEAR CSV (Copiar la misma de index.html) ---
            function parsearCSV(csvText) {
                // ... (Tu implementación de parsearCSV aquí) ...
                const rows = csvText.split('\n').filter(row => row.trim() !== '');
                if (rows.length === 0) return [];

                const headers = rows[0].split(',').map(header => header.trim().replace(/[\ufeff\r]/g, ''));
                const data = [];

                for (let i = 1; i < rows.length; i++) {
                    let currentRow = rows[i];
                    let rowData = {};
                    let inQuotes = false;
                    let field = '';
                    let headerIndex = 0;
                    let char;

                    for (let j = 0; j < currentRow.length; j++) {
                        char = currentRow[j];

                        if (char === '"') {
                            if (inQuotes && j + 1 < currentRow.length && currentRow[j + 1] === '"') {
                                field += '"';
                                j++;
                            } else {
                                inQuotes = !inQuotes;
                            }
                        } else if (char === ',' && !inQuotes) {
                            if (headers[headerIndex]) {
                                rowData[headers[headerIndex]] = field.trim();
                            }
                            field = '';
                            headerIndex++;
                        } else {
                            field += char;
                        }
                    }
                    if (headers[headerIndex]) {
                        rowData[headers[headerIndex]] = field.trim();
                    }
                    data.push(rowData);
                }

                return data.filter(item => item['Nombre Completo'] && item['Tu Testimonio'] && item['Calificación'] && item['Fecha']);
            }
            // --- FIN FUNCIÓN PARA PARSEAR CSV ---


            fetch(csvUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(csvText => {
                    const comentarios = parsearCSV(csvText);

                    if (comentarios.length > 0) {
                        // Iterar sobre *todos* los comentarios y crear sus tarjetas
                        comentarios.forEach(comentario => {
                            const nombre = comentario['Nombre Completo'] || 'Anónimo';
                            const testimonioCompleto = comentario['Tu Testimonio'] || 'Sin testimonio';
                            const calificacion = comentario['Calificación'] || 'N/A';
                            const fecha = comentario['Fecha'] || '';

                            let fechaFormateada = fecha;
                            try {
                                const partesFecha = fecha.split('/');
                                if (partesFecha.length === 3) {
                                    const año = partesFecha[2].length === 2 ? `20${partesFecha[2]}` : partesFecha[2];
                                    const fechaObj = new Date(año, partesFecha[1] - 1, partesFecha[0]);
                                    const dia = fechaObj.getDate().toString().padStart(2, '0');
                                    const mes = (fechaObj.getMonth() + 1).toString().padStart(2, '0');
                                    const añoCompleto = fechaObj.getFullYear();
                                    fechaFormateada = `${dia}/${mes}/${añoCompleto}`;
                                } else {
                                    fechaFormateada = fecha.split(' ')[0] || '';
                                }
                            } catch (e) {
                                console.error("Error parseando fecha:", fecha, e);
                                fechaFormateada = fecha.split(' ')[0] || '';
                            }


                            // Construir la tarjeta HTML para cada testimonio (sin "Ver más/menos" aquí)
                            const tarjetaHTML = `
                                 <div class="comentario-tarjeta">
                                     <p class="testimonio">"${testimonioCompleto}"</p>
                                     <p class="nombre">${nombre}</p>
                                     <div class="calificacion-fecha">
                                         <span class="calificacion">Calificación: ${calificacion}/5</span>
                                         <span class="fecha">Fecha: ${fechaFormateada}</span>
                                     </div>
                                 </div>
                             `;
                            // Añadir la tarjeta al contenedor del grid
                            gridTestimoniosContenedor.innerHTML += tarjetaHTML;
                        });

                    } else {
                        // Si no se cargaron comentarios
                        gridTestimoniosContenedor.innerHTML = '<p class="text-center text-gray-600">No hay testimonios para mostrar en este momento.</p>';
                    }

                })
                .catch(error => {
                    console.error('Error al cargar los testimonios:', error);
                    gridTestimoniosContenedor.innerHTML = '<p class="text-center text-red-500">Error al cargar los testimonios.</p>';
                });
        });
        // === Fin JavaScript para Testimonios Completos ===

        // === JavaScript para recargar links a index (Opcional, copiar si lo necesitas) ===
        const indexLinks = document.querySelectorAll('a[href^="/index.html#"]'); // Links a /index.html#...
        indexLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                // Opcional: Evitar el comportamiento predeterminado y forzar recarga
                // event.preventDefault();
                // window.location.href = link.href; // Navega y luego recarga
                // window.location.reload(true); // Esto recargaría SIEMPRE, incluso si ya estás en index
                // Una mejor opción es solo navegar:
            });
        });

    </script>

</body>

</html>